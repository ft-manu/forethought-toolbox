const fs = require('fs');
const path = require('path');

// Mapping from display_name to org_id (as string)
const orgMap = {
  "granicus": 1459,
  "payscale": 1458,
  "stubhub": 1457,
  "gainsight": 1456,
  "ncontracts sandbox": 1455,
  "bk8": 1454,
  "perlman": 1453,
  "credit-genie-sbox": 1452,
  "fwrbrands": 1451,
  "Infoblox": 1450,
  "nuvocargo": 1449,
  "confluent": 1448,
  "Point of Rental": 1447,
  "YES Network": 1446,
  "Grid": 1445,
  "outsourceddoers": 1444,
  "PlanetDDS": 1443,
  "Acquia": 1442,
  "tapcheck-sanbox": 1441,
  "aura": 1440,
  "opengov": 1438,
  "CentralSquare": 1437,
  "inkind": 1436,
  "netflix": 1435,
  "GoCardless": 1434,
  "qualia": 1433,
  "ActiveCampaign - sandbox": 1432,
  "unanet": 1431,
  "TRG Screen": 1430,
  "Formstack Sandbox": 1429,
  "Insightsoftware Sandbox": 1428,
  "nourish": 1427,
  "renaissance-full-sandbox": 1426,
  "greenwayhealth": 1425,
  "constrafor": 1424,
  "firstbase": 1422,
  "sovos": 1421,
  "lodgify": 1420,
  "assent": 1419,
  "xref": 1418,
  "evvy": 1417,
  "qualtrics-internal": 1415,
  "airalo": 1414,
  "pawp": 1413,
  "circle": 1412,
  "Qualtrics": 1411,
  "vsco": 1410,
  "nextdoor": 1409,
  "ISW-test": 1408,
  "unleash": 1407,
  "wills-org": 1406,
  "revalize": 1405,
  "trackforce": 1404,
  "Headway-sandbox": 1403,
  "netgear": 1402,
  "ian-test": 1401,
  "evergreen-wealth-sandbox": 1400,
  "Test 123": 1398,
  "redgate": 1397,
  "BYD": 1396,
  "agentic-assist-sf-test": 1394,
  "sage-halocrm": 1393,
  "Manu's Org": 1392,
  "tuition": 1391,
  "inflowinventory": 1390,
  "Maven Clinic": 1389,
  "agentic-assist-sami": 1388,
  "agentic-assist-test": 1387,
  "Homestory": 1386,
  "teemazing": 1385,
  "agent-assist-bug-bash": 1384,
  "credit-genie": 1383,
  "tala": 1382,
  "taimi": 1381,
  "iHealth": 1380,
  "wellesterhealth": 1378,
  "Distilled - DoneDeal Test": 1377,
  "foundation": 1376,
  "Avalara": 1375,
  "nicole-org": 1374,
  "onboarding": 1373,
  "Weitian Voice Test 2": 1372,
  "Weitian Voice Test": 1371,
  "runway": 1370,
  "retail-me-not": 1369,
  "Forethought Internal Slack": 1368,
  "jtl": 1366,
  "Team BIG": 1365,
  "Havenly Sandbox": 1364,
  "G2 Sandbox": 1363,
  "Test org 222aa": 1362,
  "Test org 111a<h1>a": 1361,
  "mealticket": 1360,
  "agentic-assist": 1359,
  "hummingbirds": 1358,
  "gszeto-test-1": 1357,
  "paylocity": 1356,
  "ncontracts": 1355,
  "tapcheck": 1354,
  "litera": 1353,
  "Cohere": 1352,
  "fixdapp": 1351,
  "bsasoftware": 1350,
  "Passport Global": 1347,
  "ethena": 1346,
  "Billtrust Sandbox": 1344,
  "Intercom se2": 1343,
  "meundies": 1342,
  "consensys": 1340,
  "macmillan": 1338,
  "thumbtack-trial": 1337,
  "orderbird": 1336,
  "evcs": 1335,
  "Calibrate-Sandbox": 1333,
  "arcoro": 1332,
  "Wallee": 1331,
  "Glencoco": 1330,
  "google-review-app1": 1328,
  "Lever Sandbox": 1327,
  "hatch-sandbox": 1326,
  "TSETrainingExample": 1325,
  "mercuryo": 1324,
  "Maven Sandbox": 1323,
  "tse-mock-12": 1322,
  "G2": 1319,
  "Weitian Test 6": 1316,
  "Front Elevate Demo": 1315,
  "Horatio Elevate Demo": 1314,
  "TuneCore Elevate Demo": 1313,
  "Elastic Elevate Demo": 1312,
  "PagerDuty Elevate Demo": 1311,
  "Capsule Elevate Demo": 1310,
  "Canopy and Stars Elevate Demo": 1309,
  "Buffer Elevate Demo": 1308,
  "Balsamiq Elevate Demo": 1307,
  "Artfinder": 1306,
  "Argus Elevate Demo": 1305,
  "Archways Elevate Demo": 1304,
  "AppFollow Elevate Demo": 1303,
  "AllThingsCX Elevate Demo": 1302,
  "ACJB Consulting Elevate Demo": 1301,
  "Abcam Elevate Demo": 1300,
  "Tailscale Elevate Demo 3": 1299,
  "Tailscale Elevate Demo 2": 1298,
  "Tailscale (Elevate Demo)": 1297,
  "MediShout (Elevate Test)": 1296,
  "TuneCoreTest": 1295,
  "Maxio": 1294,
  "formstack": 1293,
  "Lucanet": 1292,
  "Heimdal": 1291,
  "uniswap": 1290,
  "carerev": 1289,
  "insightsoftware": 1288,
  "thirdlove": 1286,
  "AlayaCare": 1284,
  "FuboTV": 1283,
  "recraft": 1282,
  "Oura": 1281,
  "d3vmax2": 1280,
  "Tebra Production": 1279,
  "Truework": 1278,
  "Clair": 1276,
  "Wisetack": 1275,
  "forethought.ai": 1274,
  "momentus": 1273,
  "cloaked": 1272,
  "Carta Sandbox": 1271,
  "YNAB Sandbox": 1270,
  "test": 1269,
  "havenly": 1268,
  "Alyce": 1267,
  "Omneky": 1266,
  "rollbar": 1265,
  "CyberpowerPC": 1264,
  "Predibase": 1263,
  "Billtrust": 1261,
  "Stake": 1260,
  "AA SFDC Messaging": 1259,
  "Duetto Sandbox": 1256,
  "onecause-sandbox": 1255,
  "lmn": 1254,
  "CSM Training": 1253,
  "CSM Training Fake": 1252,
  "Greenhouse": 1247,
  "Automattic": 1245,
  "360Learning": 1244,
  "Datadog Sandbox": 1243,
  "Assist ZD Messaging": 1239,
  "HHAeXchange": 1238,
  "private-ai": 1237,
  "player-zero": 1236,
  "BeginHealth": 1234,
  "neon": 1232,
  "Peek": 1231,
  "Mitratech Sandbox": 1229,
  "renaissance-fd": 1228,
  "Carta": 1227,
  "Bright SG Ltd": 1226,
  "test-zd-messaging": 1225,
  "Wag Sandbox": 1224,
  "aarons-test": 1223,
  "CashWise": 1222,
  "grammarly": 1220,
  "babylist": 1219,
  "Weitian Test 4": 1218,
  "Weitian Test 3": 1217,
  "Weitian Test 5": 1215,
  "Weitian Test 2": 1213,
  "Corsair Sandbox": 1212,
  "Lara-org": 1211,
  "grants-org1": 1210,
  "Equisoft": 1209,
  "Weitian Test": 1208,
  "Deon Sandbox": 1206,
  "solve-freshchat": 1205,
  "Haven": 1203,
  "kroo-sandbox": 1200,
  "Greenhouse Sandbox": 1199,
  "Shitij- Test": 1198,
  "Sage": 1197,
  "Perks at Work": 1195,
  "grants-org": 1194,
  "Paramount": 1193,
  "styleseat-demo": 1192,
  "FDE-jira": 1190,
  "personify": 1189,
  "Tebra-Sandbox": 1188,
  "iFIT-uk": 1187,
  "navitas": 1186,
  "FDE-kustomer": 1185,
  "HealthEngine": 1184,
  "Calibrate": 1183,
  "evergreen-wealth": 1182,
  "wrike": 1181,
  "fiverr": 1180,
  "SpeedX": 1179,
  "mentorcliq": 1178,
  "finaldraft": 1177,
  "smalls": 1176,
  "Lose It": 1175,
  "imprint": 1174,
  "gszeto-test": 1173,
  "test-org-test": 1172,
  "duettoresearch": 1171,
  "codesignal": 1170,
  "fetch": 1169,
  "Proper Cloth": 1168,
  "reviewwave": 1167,
  "Harri": 1165,
  "pendo": 1163,
  "hipcamp": 1162,
  "onecause": 1160,
  "QSC Sandbox": 1159,
  "influenster": 1158,
  "Deel": 1157,
  "Deel": 1155,
  "Deel": 1153,
  "Deel": 1151,
  "Deel": 1149,
  "brendan-test-1": 1147,
  "squire-sandbox": 1146,
  "Deel": 1145,
  "Deel": 1143,
  "YNAB": 1141,
  "scaleai": 1140,
  "ActiveCampaign": 1139,
  "Qover": 1138,
  "renaissance-sf-sandbox": 1136,
  "dbt Labs": 1135,
  "thrizer": 1134,
  "Keller Postman": 1133,
  "qoria-qustodio": 1132,
  "Vivli-Prod": 1131,
  "GoCanvas": 1129,
  "SiteDocs": 1128,
  "icims-sandbox": 1125,
  "Leadpages": 1123,
  "Lime Sandbox": 1122,
  "Sam's Test Org": 1120,
  "elementor-sandbox": 1117,
  "wag": 1116,
  "Movano": 1114,
  "HiHello, Inc.": 1113,
  "talkspace": 1112,
  "Pendulum": 1110,
  "qoria": 1108,
  "Bitsight Sandbox": 1107,
  "Triage LLM Playground": 1106,
  "test-contact-support": 1105,
  "NexTech": 1104,
  "Cloudbeds Streaming Demo": 1103,
  "addigy": 1101,
  "form": 1100,
  "testgorilla": 1099,
  "solawave": 1097,
  "Company": 1096,
  "Company": 1095,
  "WP Engine Sandbox": 1094,
  "Whatnot": 1093,
  "corsair": 1091,
  "tailscale": 1090,
  "Ridge": 1089,
  "testgordo": 1088,
  "Mailgun Deliverability Ninja (Test)": 1087,
  "notion-sandbox": 1086,
  "Juniper Networks DEON TEST": 1085,
  "ShipperHQ": 1084,
  "SmugMug": 1082,
  "oktaappreview": 1081,
  "Forethought fake company": 1080,
  "airtable-sandbox": 1079,
  "crunchtime": 1078,
  "peerspace": 1077,
  "WP Engine": 1075,
  "Jaggaer": 1074,
  "Evegeny E2E": 1069,
  "josephine-test": 1068,
  "andres-email-SF": 1067,
  "charlie-solve-email-sf": 1064,
  "Zach Test SF Email": 1063,
  "Airtable": 1062,
  "yext": 1061,
  "QSYS Sandbox": 1060,
  "hatch": 1059,
  "whatnot": 1058,
  "Engagement Management": 1057,
  "icims-test-org": 1056,
  "flickr": 1054,
  "Mosaic": 1053,
  "descript": 1052,
  "Fakecomp": 1051,
  "skyview": 1049,
  "Renaissance-US": 1048,
  "phrase": 1047,
  "Kroo": 1046,
  "Spring Meadow": 1044,
  "BirdyGrey": 1043,
  "BitSight": 1042,
  "tanner-zd-demo": 1040,
  "forethought": 1038,
  "Rula": 1034,
  "ethoslife-partnerships": 1033,
  "HiBob": 1032,
  "ft": 1031,
  "elementor": 1030,
  "Board": 1029,
  "test-8llh": 1027,
  "Test Org-2A5x": 1024,
  "Ruggable": 1021,
  "google-2z5U": 1019,
  "google-DTLl": 1014,
  "google": 1013,
  "quorum": 1011,
  "testjad": 1009,
  "solve-lite-test-2": 1005,
  "Deel Test Oct 18": 1004,
  "tanner_test": 1003,
  "roger_sf_test": 1002,
  "Gaille Test": 1001,
  "ZALORA Indonesia": 999,
  "ZALORA Phillipines": 998,
  "Sinch": 996,
  "Cloudbeds - Historic Data": 995,
  "AWeber": 994,
  "Deel": 985,
  "rowens-pick-and-shovel": 983,
  "wonder-sandbox": 982,
  "lattice": 981,
  "bexio": 979,
  "charlie test": 978,
  "logicmonitor": 977,
  "QAD-Stage": 976,
  "magoosh": 975,
  "PayMaven": 974,
  "FrogSaladEaters": 973,
  "cratejoy-sandbox": 972,
  "asdfasdfa": 971,
  "zoominfo-sandbox": 970,
  "acme corp": 967,
  "Lion Brand Yarn": 965,
  "Scadriel": 963,
  "FDE-slingshot": 962,
  "jamestest": 961,
  "Deel Human Resources": 958,
  "Safesend": 956,
  "icims": 953,
  "ColumnTax": 952,
  "SpotOn": 951,
  "daxko": 949,
  "Lattice Sandbox": 946,
  "Cloudbeds": 944,
  "QAD": 943,
  "test-onboarding": 942,
  "Klipi": 940,
  "gailles-org": 932,
  "Flexport Demo": 931,
  "sage-sandbox": 929,
  "Deel HR": 925,
  "Zendesk Test Demo 3": 924,
  "Deel HR": 923,
  "zendesk demo test 1": 920,
  "brendan-test-handoff": 919,
  "Paymint": 918,
  "onboard-handoff-test-2": 917,
  "onboard-handoff-test-1": 916,
  "Gusto Integration Test 2": 915,
  "Gather": 914,
  "SmartShop": 913,
  "Zach-Test-Email": 911,
  "CoreSolveLite": 909,
  "Celtra": 905,
  "Gusto Integration Test": 903,
  "ft-notion-test": 896,
  "salesloft-sandbox": 895,
  "ak-test": 894,
  "SuperSonic": 893,
  "Yazio": 891,
  "salesforce-assist-demo": 889,
  "autonomous-agent-demo": 888,
  "intiveo": 887,
  "roadie-sf-sandbox": 886,
  "solve-lite-demo-sam-1": 885,
  "roadie-sf": 884,
  "Gusto Test": 882,
  "widget revamp demo": 881,
  "deel": 880,
  "ethoslife": 879,
  "Headway": 878,
  "CloudCorp": 877,
  "Pallium": 876,
  "ZALORA": 875,
  "Old CashWise": 872,
  "ShopZone": 871,
  "Jobvite": 869,
  "Forma": 867,
  "rippling-demo": 865,
  "Rippling": 864,
  "squire": 857,
  "Workable": 856,
  "treez": 850,
  "Solve UI E2E Test Org (Zendesk)": 847,
  "freshdesk-custom": 845,
  "Macy's": 839,
  "Macy's": 838,
  "Macy's": 837,
  "noom-demo": 835,
  "Solve Lite Demo": 829,
  "jamie-test": 824,
  "brendan": 823,
  "d3v-zach": 822,
  "Flowspace Production": 821,
  "solve-lite-test": 818,
  "justworks-sandbox": 815,
  "Flowspace Salesforce": 810,
  "Flowspace Salesforce": 809,
  "cv2-rollout-test": 808,
  "cv2-rollout-control": 807,
  "Navigate360": 805,
  "JJo": 802,
  "popmenu": 799,
  "ParadeDeck": 790,
  "fetch-sandbox": 784,
  "viome": 782,
  "forethought-for-you": 781,
  "d3v-murt": 780,
  "weitian_test": 774,
  "noom-testing": 773,
  "Mehaylaz-Potatoes": 769,
  "MHCCC-sandbox": 767,
  "FDE": 766,
  "clearcompany": 765,
  "Carfax Sandbox": 760,
  "Carfax": 759,
  "notion": 757,
  "eng-ops-analytics": 755,
  "forethought-ios-android-sdk": 754,
  "salesloft--dev": 752,
  "scribd": 750,
  "Brondell": 748,
  "Forethought": 747,
  "vgs-sandbox": 745,
  "act-on": 744,
  "act-on-trial": 743,
  "denise-test": 740,
  "stark-bank-sf": 737,
  "scribd-demo": 731,
  "blackthorn-sandbox": 730,
  "forethought-intercom-oauth": 729,
  "trilogy": 728,
  "cotopaxi": 727,
  "testsalina": 723,
  "scribd-sandbox": 722,
  "stark-shop-sf": 719,
  "KOHO": 713,
  "Medecins Sans Frontieres": 712,
  "test-sunco-shef": 710,
  "stark-shop-kustomer": 705,
  "stark-shop-intercom": 704,
  "stark-ai-intercom": 703,
  "stark-bank-intercom": 702,
  "forethought-sales": 698,
  "forethought-for-good": 695,
  "stark-tech-intercom": 694,
  "Code.Org": 693,
  "Mitsubishi-HCC": 691,
  "Blackthorn": 689,
  "kickfin-develoco-sandbox": 688,
  "kickfin-partial-sandbox": 687,
  "noom-growth": 686,
  "forethought-intercom-demo": 685,
  "servicenow-demo": 682,
  "forethought-intercom": 680,
  "Achievers-sandbox": 678,
  "Koho Test": 673,
  "Airbase": 671,
  "triage-test-234": 670,
  "kickfin": 668,
  "Achievers": 667,
  "Solve-bot": 665,
  "Generic Helpdesk Demo": 654,
  "latam-demo": 650,
  "helloheart": 647,
  "iPro": 645,
  "triage-discover-test": 644,
  "forethought-training": 640,
  "sesame": 637,
  "YenFlameThrower": 630,
  "clickup-sandbox": 626,
  "upwork1607994371": 621,
  "spordle": 620,
  "ie-mock-1": 618,
  "zach-sunco-demo": 617,
  "bigcommerce": 616,
  "clickup": 615,
  "cindy-zendesk-demo": 614,
  " Noom Support": 613,
  "RVW's Sandbox": 609,
  "YenDemoOrg": 595,
  "session": 594,
  "bigcommerce-sandbox": 585,
  "Vivino-sandbox": 583,
  "gusto-site-search2": 381,
  "ZD_CUST": 299
};

const inputPath = path.join(__dirname, 'bookmarks_fixed_enhanced.json');
const outputPath = path.join(__dirname, 'bookmarks_fixed_enhanced_with_orgid.json');

const data = JSON.parse(fs.readFileSync(inputPath, 'utf8'));

function updateDashboardUrl(url) {
  // Only update dashboard-int.forethought.tech/discover/dashboard?org=...
  const match = url.match(/dashboard-int\.forethought\.tech\/discover\/dashboard\?org=([^&]+)/);
  if (!match) return url;
  const orgName = decodeURIComponent(match[1]).trim();
  // Try direct match, else try lowercased, else leave as is
  let orgId = orgMap[orgName] || orgMap[orgName.trim()] || orgMap[orgName.toLowerCase()];
  if (!orgId) {
    // Try to match ignoring case and spaces
    const found = Object.entries(orgMap).find(([name]) => name.replace(/\s+/g, '').toLowerCase() === orgName.replace(/\s+/g, '').toLowerCase());
    if (found) orgId = found[1];
  }
  if (!orgId) {
    console.warn(`No org_id found for org name: '${orgName}' in URL: ${url}`);
    return url;
  }
  return url.replace(/org=[^&]+/, `org=${orgId}`);
}

function processBookmarks(bookmarks) {
  return bookmarks.map(bm => {
    if (bm.url && typeof bm.url === 'string' && bm.url.includes('dashboard-int.forethought.tech/discover/dashboard?org=')) {
      return { ...bm, url: updateDashboardUrl(bm.url) };
    }
    return bm;
  });
}

const updated = Array.isArray(data) ? processBookmarks(data) : data;
fs.writeFileSync(outputPath, JSON.stringify(updated, null, 2), 'utf8');
console.log('Updated dashboard URLs with org_id. Output:', outputPath); 